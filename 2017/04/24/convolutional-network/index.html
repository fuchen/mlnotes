<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>卷积神经网络 | Machine Learning Notes</title><link rel="stylesheet" type="text/css" href="/mlnotes/css/style.css"><link rel="stylesheet" type="text/css" href="/mlnotes/css/notebook.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/6.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.2/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/mlnotes/favicon.ico"><link rel="apple-touch-icon" href="/mlnotes/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/mlnotes/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">卷积神经网络</h1><a id="logo" href="/mlnotes/.">Machine Learning Notes</a><p class="description"></p></div><div id="nav-menu"><a href="/mlnotes/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/mlnotes/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/mlnotes/about/"><i class="fa fa-user"> 关于</i></a><a href="/mlnotes/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">卷积神经网络</h1><div class="post-meta">Apr 24, 2017<span> | </span><span class="category"><a href="/mlnotes/categories/机器学习笔记/">机器学习笔记</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="post-content"><img src="/mlnotes/2017/04/24/convolutional-network/LeNet.jpg" alt="LeNet" title="LeNet">
<a id="more"></a>
<h3 id="卷积神经网络的构成"><a href="#卷积神经网络的构成" class="headerlink" title="卷积神经网络的构成:"></a>卷积神经网络的构成:</h3><ul>
<li><strong>输入层</strong>：可以是任意维度的数据。一般要求每个维度的长度都满足 <span class="mathjax"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.381ex" height="2.176ex" style="vertical-align: -0.338ex;" viewbox="0 -791.3 1025.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title"><title id="MathJax-SVG-1-Title">2^n</title><defs aria-hidden="true"><path stroke-width="1" id="E1-MJMAIN-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"/><path stroke-width="1" id="E1-MJMATHI-6E" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"/></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"> <use xlink:href="#E1-MJMAIN-32" x="0" y="0"/> <use transform="scale(0.707)" xlink:href="#E1-MJMATHI-6E" x="707" y="557"/></g></svg></span>，以便池化。</li>
<li><strong>卷积层</strong>：通过<code>K</code>个卷积核，把输入层转化为<code>K</code>个特征图。</li>
<li><strong>池化层</strong>：压缩特征图大小，以提高训练速度，和避免过拟合。</li>
<li><strong>全连接层</strong>：映射到结果集。</li>
</ul>
<h3 id="卷积层"><a href="#卷积层" class="headerlink" title="卷积层"></a>卷积层</h3><img src="/mlnotes/2017/04/24/convolutional-network/conv_layer.png" alt="卷积操作" title="卷积操作">
<img src="/mlnotes/2017/04/24/convolutional-network/conv_kernel.png" alt="卷积核 - 匹配失败" title="卷积核 - 匹配失败">
<img src="/mlnotes/2017/04/24/convolutional-network/conv_kernel_2.png" alt="卷积核 - 匹配成功" title="卷积核 - 匹配成功">
<p>超参数：</p>
<ul>
<li><strong><code>depth</code></strong>: 卷积核的数量</li>
<li><strong><code>size</code></strong>: 卷积核的大小。维度与输入数据相同。</li>
<li><strong><code>stride</code></strong>: 采样间距。由于存在池化/Dropout，<code>stride</code>通常设置为 <code>1</code>。</li>
<li><strong><code>padding</code></strong>: Padding规则。</li>
</ul>
<p>一个卷积神经网络可能包含多个卷积层。</p>
<p>越靠前面的层，提取到的特征越简单，卷积核数量越少。越靠后面的层，卷积核数量越多。这是因为其输入已经不是像素点，而是具有一定复杂度的低级特征，组合爆炸可以构建出更多的复杂特征。</p>
<p>换个角度看，越前面的层，其卷积核的感受野越小，特征数也少。越后面的层，其卷积核的感受野越大，特征数自然也就更多。</p>
<h3 id="经典的卷积神经网络结构"><a href="#经典的卷积神经网络结构" class="headerlink" title="经典的卷积神经网络结构"></a>经典的卷积神经网络结构</h3><ol>
<li>LeNet：其结构图见本文开头。每个卷积层对应一个池化层。</li>
<li><p><a href="http://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks.pdf" target="_blank" rel="external">AlexNet</a>：</p>
<img src="/mlnotes/2017/04/24/convolutional-network/AlexNet.png" alt="AlexNet" title="AlexNet">
<p>结构特点为：</p>
<ul>
<li>增加了网络深度</li>
<li>使用了连续的卷积层</li>
</ul>
<p>其他：</p>
<ul>
<li>使用PCA方法给RGB加了噪声，以降低过拟合</li>
</ul>
</li>
<li>ZF Net：结构同 AlexNet。区别在于每个卷积层的卷积核数量加倍，第一层的卷积核大小和stride缩小。</li>
<li><a href="https://arxiv.org/pdf/1602.07261.pdf" target="_blank" rel="external">GoogleNet (Inception-v4)</a>：<img src="/mlnotes/2017/04/24/convolutional-network/GoogleNet_Inception.png" alt="Incepiton Module" title="Incepiton Module">
主要特点：<ul>
<li>使用了多种不同的 Inception Module，部分取代单一路径的卷积层。Inception Module 里的多条路径，可以理解为多种不同的功能。反向传播时，自动选择最合适的功能进行加强。</li>
<li>顶层用 Avarage Pooling 取代全连接。</li>
<li>注意，Inception Module 里包含了 1X1 Conv。1X1 Conv 之所以有存在意义，是因为卷积操作是具有深度的。不同深度层次上的值，代表了不同的feature，所以 1X1 Conv 可以提取该点的 feature 组合。</li>
</ul>
</li>
<li><a href="http://www.robots.ox.ac.uk/~vgg/research/very_deep/" target="_blank" rel="external">VGGNet</a>：从头到尾 3X3 Conv + 2X2 Pooling，但就是深。</li>
<li><a href="https://arxiv.org/abs/1512.03385" target="_blank" rel="external">ResNet</a>：<img src="/mlnotes/2017/04/24/convolutional-network/ResNet_shortcut.png" alt="ResNet Shortcut" title="ResNet Shortcut">
主要特点：<ul>
<li>每隔几层引入了一条 shortcut，把网络深度的增加变成了一个逐步集成的过程。即每加一层，性能不应该变得更差。由于加法操作的存在，反向传播的时候，图中的 X identity 能起到稳定器的作用。</li>
<li>与 GoogleNet 一样，顶层也采用了 Avg Pool。</li>
</ul>
</li>
</ol>
</div><script type="text/javascript" src="/mlnotes/js/share.js" async></script><a data-url="https://fuchen.github.io/mlnotes/2017/04/24/convolutional-network/" data-id="cj1xq72ha0004skq4zue87ht5" class="article-share-link">分享到</a><div class="tags"><a href="/mlnotes/tags/神经网络/">神经网络</a><a href="/mlnotes/tags/卷积神经网络/">卷积神经网络</a><a href="/mlnotes/tags/CNN/">CNN</a></div><div class="post-nav"><a href="/mlnotes/2017/04/23/implement-multilayer-perceptron/" class="pre">Tensorflow 实现多层感知机</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://fuchen.github.io/mlnotes"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/mlnotes/categories/机器学习笔记/">机器学习笔记</a></li><li class="category-list-item"><a class="category-list-link" href="/mlnotes/categories/练习/">练习</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/mlnotes/tags/softmax/" style="font-size: 15px;">softmax</a> <a href="/mlnotes/tags/逻辑回归/" style="font-size: 15px;">逻辑回归</a> <a href="/mlnotes/tags/线性回归/" style="font-size: 15px;">线性回归</a> <a href="/mlnotes/tags/神经网络/" style="font-size: 15px;">神经网络</a> <a href="/mlnotes/tags/MNIST/" style="font-size: 15px;">MNIST</a> <a href="/mlnotes/tags/notebook/" style="font-size: 15px;">notebook</a> <a href="/mlnotes/tags/卷积神经网络/" style="font-size: 15px;">卷积神经网络</a> <a href="/mlnotes/tags/CNN/" style="font-size: 15px;">CNN</a> <a href="/mlnotes/tags/反向传播/" style="font-size: 15px;">反向传播</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/mlnotes/2017/04/24/convolutional-network/">卷积神经网络</a></li><li class="post-list-item"><a class="post-list-link" href="/mlnotes/2017/04/23/implement-multilayer-perceptron/">Tensorflow 实现多层感知机</a></li><li class="post-list-item"><a class="post-list-link" href="/mlnotes/2017/04/20/neural-network/">神经网络</a></li><li class="post-list-item"><a class="post-list-link" href="/mlnotes/2017/04/18/regression-and-classification/">回归与分类</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://tasty.pub/" title="Tasty Pub" target="_blank">Tasty Pub</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/mlnotes/." rel="nofollow">Machine Learning Notes.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/mlnotes/js/totop.js" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/mlnotes/js/fancybox.js" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.0.47/jquery.fancybox.min.css"><script type="text/javascript" src="/mlnotes/js/codeblock-resizer.js"></script><script type="text/javascript" src="/mlnotes/js/smartresize.js"></script></div></body></html>